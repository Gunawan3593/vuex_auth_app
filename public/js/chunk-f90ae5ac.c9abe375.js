(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f90ae5ac"],{"368e":function(t,e,n){},d5b5:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-row",{attrs:{align:"center",justify:"center"}},[n("v-col",{attrs:{cols:"12",sm:"8",md:"12"}},[n("v-card",{staticClass:"elevation-12"},[n("v-toolbar",{attrs:{color:"primary",dark:"",flat:""}},[n("v-toolbar-title",[t._v("Add Sales Order")]),n("v-spacer"),n("v-toolbar-title",[n("v-tooltip",{attrs:{left:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,a=e.attrs;return[n("v-btn",t._g(t._b({attrs:{icon:"",color:"dee-orange"},on:{click:function(e){return t.Back()}}},"v-btn",a,!1),i),[n("v-icon",[t._v("mdi-arrow-left-bold")])],1)]}}])},[n("span",[t._v("Back to List")])]),n("v-tooltip",{attrs:{left:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,a=e.attrs;return[n("v-btn",t._g(t._b({attrs:{icon:"",color:"dee-orange",link:"",to:"/sales/order/add"}},"v-btn",a,!1),i),[n("v-icon",[t._v("mdi-restore")])],1)]}}])},[n("span",[t._v("New Data")])]),n("v-tooltip",{attrs:{left:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,a=e.attrs;return[n("v-btn",t._g(t._b({attrs:{icon:"",color:"dee-orange",loading:t.isLoading,disabled:t.isLoading},on:{click:t.submit}},"v-btn",a,!1),i),[n("v-icon",[t._v("mdi-content-save-move-outline")])],1)]}}])},[n("span",[t._v("Save Data")])])],1)],1),n("v-card-text",[n("v-form",[n("v-row",[n("v-col",{attrs:{cols:"12",sm:"12",md:"4"}},[n("v-text-field",{attrs:{label:"No.","prepend-icon":"mdi-numeric",type:"text",readonly:""},model:{value:t.fields.no,callback:function(e){t.$set(t.fields,"no",e)},expression:"fields.no"}})],1),n("v-col",{attrs:{cols:"12",sm:"12",md:"4"}},[n("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"290px"},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;return[n("v-text-field",t._g({attrs:{label:"Date","prepend-icon":"mdi-calendar",readonly:""},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}},i))]}}]),model:{value:t.menu,callback:function(e){t.menu=e},expression:"menu"}},[n("v-date-picker",{on:{input:function(e){t.menu=!1}},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}})],1)],1),n("v-col",{attrs:{cols:"12",sm:"12",md:"4"}},[n("v-autocomplete",{attrs:{"error-messages":t.customerErrors,required:"",items:t.customerItems,"hide-no-data":"","hide-selected":"","item-text":"Description","item-value":"_id",label:"Customers",placeholder:"Start typing to Search","prepend-icon":"mdi-dresser","return-object":!1},on:{input:function(e){return t.$v.fields.customer.$touch()},blur:function(e){return t.$v.fields.customer.$touch()}},model:{value:t.fields.customer,callback:function(e){t.$set(t.fields,"customer",e)},expression:"fields.customer"}})],1)],1)],1),n("v-row",[n("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[n("v-autocomplete",{attrs:{items:t.productItems,"hide-no-data":"","hide-selected":"","item-text":"Description",label:"Product",placeholder:"Select Product","prepend-icon":"mdi-database-search","return-object":""},on:{change:function(e){return t.addItem()}},model:{value:t.productSelected,callback:function(e){t.productSelected=e},expression:"productSelected"}})],1),n("v-col",{attrs:{cols:"12",sm:"6",md:"8"}},[n("p",{staticClass:"display-2 text-right",staticStyle:{"padding-right":"10px"}},[t._v("Total : "+t._s(t._f("currency")(t.getSubtotal)))])])],1),n("v-row",[n("v-col",{attrs:{cols:"12",sm:"12",md:"12"}},[n("v-simple-table",{attrs:{dense:""},scopedSlots:t._u([{key:"default",fn:function(){return[n("thead",[n("tr",[n("th",{staticClass:"text-center"},[t._v("Name")]),n("th",{staticClass:"text-center",attrs:{width:"100px"}},[t._v("Stock")]),n("th",{staticClass:"text-center",attrs:{width:"100px"}},[t._v("Qty")]),n("th",{staticClass:"text-center",attrs:{width:"200px;"}},[t._v("Price")]),n("th",{staticClass:"text-center",attrs:{width:"200px;"}},[t._v("Total")]),n("th",{staticClass:"text-center",attrs:{width:"50px;"}},[t._v("Action")])])]),n("tbody",t._l(t.fields.items,(function(e){return n("tr",{key:e.no},[n("td",[t._v(t._s(e.name))]),n("td",[t._v(t._s(e.stock))]),n("td",[n("v-currency-field",{attrs:{"decimal-length":0,"place-holder":"Qty"},model:{value:e.qty,callback:function(n){t.$set(e,"qty",n)},expression:"item.qty"}})],1),n("td",{staticClass:"text-right"},[t._v(t._s(t._f("currency")(e.price)))]),n("td",{staticClass:"text-right"},[t._v(t._s(t._f("currency")(e.qty*e.price)))]),n("td",[n("v-icon",{attrs:{small:""},on:{click:function(n){return t.deleteItem(e)}}},[t._v(" mdi-delete ")])],1)])})),0)]},proxy:!0}])})],1)],1),n("v-row",[n("v-col",{attrs:{cols:"12",md:"6"}},[n("v-textarea",{attrs:{"prepend-icon":"mdi-note-text-outline",label:"Notes",value:"fields.notes",rows:"3"},model:{value:t.fields.notes,callback:function(e){t.$set(t.fields,"notes",e)},expression:"fields.notes"}})],1)],1)],1)],1)],1),n("v-dialog",{attrs:{persistent:"","max-width":"300px"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[n("v-card",[n("v-card-title",[n("span",{staticClass:"headline"},[t._v(t._s(t.modal.name))])]),n("v-card-text",[n("v-simple-table",{attrs:{"fixed-header":"",dense:""},scopedSlots:t._u([{key:"default",fn:function(){return[n("thead",[n("tr",[n("th",{staticClass:"text-center",attrs:{width:"50px"}},[t._v("Stock")]),n("th",{staticClass:"text-center",attrs:{width:"100px"}},[t._v("Cost")]),n("th",{staticClass:"text-center",attrs:{width:"50px"}},[t._v("Order")])])]),n("tbody",t._l(t.modal.items,(function(e){return n("tr",{key:e.cost},[n("td",[t._v(t._s(e.stock))]),n("td",[t._v(t._s(t._f("currency")(e.cost)))]),n("td",[t._v(t._s(e.qty))])])})),0)]},proxy:!0}])}),n("v-currency-field",{attrs:{"decimal-length":0,label:"Qty Order"},on:{input:function(e){return t.setModalQtyOrder(e)}},model:{value:t.modal.qty,callback:function(e){t.$set(t.modal,"qty",e)},expression:"modal.qty"}})],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(e){return t.modelSaveItem()}}},[t._v("Save")]),n("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(e){t.dialog=!1}}},[t._v("Cancel")])],1)],1)],1)],1)},a=[],s=(n("c740"),n("4160"),n("d81d"),n("a434"),n("b0c0"),n("d3b7"),n("ac1f"),n("25f0"),n("1276"),n("159b"),n("96cf"),n("1da1")),r=n("5530"),o=n("1dce"),c=n("b5ae"),d=n("2f62"),l={mixins:[o["validationMixin"]],validations:{fields:{customer:{required:c["required"]}}},computed:Object(r["a"])(Object(r["a"])({},Object(d["c"])(["user","salesOrderStatus"])),{},{customerErrors:function(){var t=[];return this.$v.fields.customer.$dirty?(!this.$v.fields.customer.required&&t.push("Customer is required."),t):t},customerItems:function(){return this.customers.map((function(t){var e=t.name;return Object.assign({},t,{Description:e})}))},productItems:function(){return this.products.map((function(t){var e=t.name;return Object.assign({},t,{Description:e})}))},getSubtotal:function(){var t=this.fields.items;if(0!=t.length){for(var e=0,n=0;n<t.length;n++)e+=t[n].qty*t[n].price;return e}}}),data:function(){return{dialog:!1,modal:{name:"",product:"",items:[],qty:0},fields:{id:!1,no:"",transdate:"",customer:"",notes:"",user:"",items:[]},date:"",customers:[],products:[],isLoading:!1,menu:!1,productSelected:"",page:"",num:0}},mounted:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,i,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getCustomer();case 2:return n=e.sent,i=n.data.data,i&&(t.customers=i),e.next=7,t.getProduct();case 7:n=e.sent,i=n.data.data,i&&(t.products=i),a=t.$route.params.id,void 0!=a?t.loadData(a):t.reset();case 12:case"end":return e.stop()}}),e)})))()},created:function(){var t=this.$route.query.page;this.page=t},methods:Object(r["a"])(Object(r["a"])({},Object(d["b"])(["getSoNo","getCustomer","getProduct","addSalesOrder","getSoItem","updateSalesOrder","getSalesOrder","checkStock","getStock"])),{},{getDateTime:function(t){var e=new Date(t),n=(new Date).getHours().toString(),i=(new Date).getMinutes().toString(),a=(new Date).getSeconds().toString(),s=("00"+n).substring(n.length)+":"+("00"+i).substring(i.length)+":"+("00"+a).substring(a.length),r=this.getDate(e);return new Date(r+" "+s)},getDate:function(t){var e=t.getTimezoneOffset();return t=new Date(t.getTime()-60*e*1e3),t.toISOString().split("T")[0]},loadData:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var i,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.getSalesOrder(t);case 2:if(i=n.sent,void 0!=i){n.next=5;break}return n.abrupt("return",e.$router.push({name:"solist"}));case 5:a=i.data.data,e.fields.id=t,e.fields.no=a.no,e.fields.notes=a.notes,e.fields.user=e.user._id,e.fields.customer=a.customer._id,e.getItem(t),e.fields.transdate=a.transdate,e.date=e.getDate(new Date(a.transdate));case 14:case"end":return n.stop()}}),n)})))()},addData:function(){var t=this;this.isLoading=!0,this.addSalesOrder(this.fields).then((function(e){e.data.success&&(t.isLoading=!1,t.$router.push("/sales/order/list"))}))},updateData:function(){var t=this;this.isLoading=!0,this.updateSalesOrder(this.fields).then((function(e){e.data.success&&(t.isLoading=!1,t.$router.push({name:"solist",params:{page:t.page}}))}))},reset:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getSoNo();case 2:n=e.sent,t.fields.id=!1,t.fields.no=n.data.code,t.date=t.getDate(new Date),t.fields.customer="",t.fields.notes="",t.fields.items=[],t.fields.user=t.user._id,t.fields.transdate=new Date;case 11:case"end":return e.stop()}}),e)})))()},getItem:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var i,a,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return i={order:t},n.next=3,e.getSoItem(i).then((function(t){if(t.data.success){var n=t.data.data;e.fields.items=[],n.forEach((function(t){t={name:t.product.name,product:t.product._id,price:t.price,qty:t.qty,stock:t.qty,no:t.no,cost:t.cost},e.fields.items.push(t)}))}}));case 3:a=e.fields.items,s={},a.forEach((function(t){s={id:t.product,cost:t.cost},e.getStock(s).then((function(e){t.stock=e.data.qty}))}));case 6:case"end":return n.stop()}}),n)})))()},addItem:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,i,a,s,r,o,c,d;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.productSelected,i=[],a={},e.next=5,t.checkStock(n._id).then((function(t){t.data.data.forEach((function(t){a={no:0,product:n._id,name:n.name,qty:0,cost:t.cost,price:n.price,stock:t.qty},i.push(a)}))}));case 5:if(s=i.length,!(s>1)){e.next=14;break}t.dialog=!0,t.modal.name=n.name,t.modal.product=n._id,t.modal.items=i,t.modal.qty=0,e.next=28;break;case 14:if(r=t.fields.items.findIndex((function(t){return t.product==n._id})),!(r>=0)){e.next=19;break}t.fields.items[r].qty+=1,e.next=28;break;case 19:return t.num+=1,o={no:t.num,product:n._id,name:n.name,qty:1,cost:0,price:n.price,stock:0},e.next=23,t.checkStock(o.product);case 23:c=e.sent,d=c.data.data,d.forEach((function(t){o.cost=t.cost,o.stock=t.qty})),t.fields.items.push(o),t.reIndexItems();case 28:t.productSelected={};case 29:case"end":return e.stop()}}),e)})))()},deleteItem:function(t){var e=this.fields.items.findIndex((function(e){return e.product===t.product}));this.fields.items.splice(e,1),this.reIndexItems()},setModalQtyOrder:function(t){var e=this;this.modal.items.forEach((function(n,i){t>n.stock?i==e.modal.items.length-1?n.qty=t:(t-=n.qty,n.qty=n.stock):(n.qty=t,t=0)}))},modelSaveItem:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=-1,t.modal.items.forEach((function(e){t.num+=1,e.no=t.num,n=t.fields.items.findIndex((function(t){return e.product==t.product&&e.cost==t.cost})),n>=0&&t.fields.items.splice(n,1),e.qty>0&&t.fields.items.push(e)})),t.reIndexItems(),t.dialog=!1;case 4:case"end":return e.stop()}}),e)})))()},reIndexItems:function(){var t=this,e=this.fields.items;this.num=0,0!=e.length&&e.forEach((function(e){t.num+=1,e.no=t.num}))},Back:function(){this.$router.push({name:"solist",params:{page:this.page}})},submit:function(){this.fields.transdate=this.getDateTime(this.date),this.$v.$touch(),this.$v.$error||(this.fields.id?this.updateData():this.addData())}})},u=l,h=n("2877"),f=n("6544"),m=n.n(f),v=n("c6a6"),p=n("8336"),g=n("b0af"),b=n("99d9"),x=n("62ad"),k=n("2e4b"),y=(n("7db0"),n("caad"),n("45fc"),n("a9e3"),n("2532"),n("498a"),n("2909")),w=n("ade3"),_=(n("368e"),n("480e")),S=n("4ad4"),O=n("b848"),C=n("75eb"),$=n("e707"),I=n("e4d3"),D=n("21be"),j=n("f2e7"),q=n("a293"),T=n("58df"),A=n("d9bd"),V=n("80d2"),E=Object(T["a"])(S["a"],O["a"],C["a"],$["a"],I["a"],D["a"],j["a"]),B=E.extend({name:"v-dialog",directives:{ClickOutside:q["a"]},props:{dark:Boolean,disabled:Boolean,fullscreen:Boolean,light:Boolean,maxWidth:{type:[String,Number],default:"none"},noClickAnimation:Boolean,origin:{type:String,default:"center center"},persistent:Boolean,retainFocus:{type:Boolean,default:!0},scrollable:Boolean,transition:{type:[String,Boolean],default:"dialog-transition"},width:{type:[String,Number],default:"auto"}},data:function(){return{activatedBy:null,animate:!1,animateTimeout:-1,isActive:!!this.value,stackMinZIndex:200}},computed:{classes:function(){var t;return t={},Object(w["a"])(t,"v-dialog ".concat(this.contentClass).trim(),!0),Object(w["a"])(t,"v-dialog--active",this.isActive),Object(w["a"])(t,"v-dialog--persistent",this.persistent),Object(w["a"])(t,"v-dialog--fullscreen",this.fullscreen),Object(w["a"])(t,"v-dialog--scrollable",this.scrollable),Object(w["a"])(t,"v-dialog--animated",this.animate),t},contentClasses:function(){return{"v-dialog__content":!0,"v-dialog__content--active":this.isActive}},hasActivator:function(){return Boolean(!!this.$slots.activator||!!this.$scopedSlots.activator)}},watch:{isActive:function(t){t?(this.show(),this.hideScroll()):(this.removeOverlay(),this.unbind())},fullscreen:function(t){this.isActive&&(t?(this.hideScroll(),this.removeOverlay(!1)):(this.showScroll(),this.genOverlay()))}},created:function(){this.$attrs.hasOwnProperty("full-width")&&Object(A["e"])("full-width",this)},beforeMount:function(){var t=this;this.$nextTick((function(){t.isBooted=t.isActive,t.isActive&&t.show()}))},beforeDestroy:function(){"undefined"!==typeof window&&this.unbind()},methods:{animateClick:function(){var t=this;this.animate=!1,this.$nextTick((function(){t.animate=!0,window.clearTimeout(t.animateTimeout),t.animateTimeout=window.setTimeout((function(){return t.animate=!1}),150)}))},closeConditional:function(t){var e=t.target;return!(this._isDestroyed||!this.isActive||this.$refs.content.contains(e)||this.overlay&&e&&!this.overlay.$el.contains(e))&&this.activeZIndex>=this.getMaxZIndex()},hideScroll:function(){this.fullscreen?document.documentElement.classList.add("overflow-y-hidden"):$["a"].options.methods.hideScroll.call(this)},show:function(){var t=this;!this.fullscreen&&!this.hideOverlay&&this.genOverlay(),this.$nextTick((function(){t.$refs.content.focus(),t.bind()}))},bind:function(){window.addEventListener("focusin",this.onFocusin)},unbind:function(){window.removeEventListener("focusin",this.onFocusin)},onClickOutside:function(t){this.$emit("click:outside",t),this.persistent?this.noClickAnimation||this.animateClick():this.isActive=!1},onKeydown:function(t){if(t.keyCode===V["x"].esc&&!this.getOpenDependents().length)if(this.persistent)this.noClickAnimation||this.animateClick();else{this.isActive=!1;var e=this.getActivator();this.$nextTick((function(){return e&&e.focus()}))}this.$emit("keydown",t)},onFocusin:function(t){if(t&&this.retainFocus){var e=t.target;if(e&&![document,this.$refs.content].includes(e)&&!this.$refs.content.contains(e)&&this.activeZIndex>=this.getMaxZIndex()&&!this.getOpenDependentElements().some((function(t){return t.contains(e)}))){var n=this.$refs.content.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),i=Object(y["a"])(n).find((function(t){return!t.hasAttribute("disabled")}));i&&i.focus()}}},genContent:function(){var t=this;return this.showLazyContent((function(){return[t.$createElement(_["a"],{props:{root:!0,light:t.light,dark:t.dark}},[t.$createElement("div",{class:t.contentClasses,attrs:Object(r["a"])({role:"document",tabindex:t.isActive?0:void 0},t.getScopeIdAttrs()),on:{keydown:t.onKeydown},style:{zIndex:t.activeZIndex},ref:"content"},[t.genTransition()])])]}))},genTransition:function(){var t=this.genInnerContent();return this.transition?this.$createElement("transition",{props:{name:this.transition,origin:this.origin,appear:!0}},[t]):t},genInnerContent:function(){var t={class:this.classes,ref:"dialog",directives:[{name:"click-outside",value:{handler:this.onClickOutside,closeConditional:this.closeConditional,include:this.getOpenDependentElements}},{name:"show",value:this.isActive}],style:{transformOrigin:this.origin}};return this.fullscreen||(t.style=Object(r["a"])(Object(r["a"])({},t.style),{},{maxWidth:"none"===this.maxWidth?void 0:Object(V["g"])(this.maxWidth),width:"auto"===this.width?void 0:Object(V["g"])(this.width)})),this.$createElement("div",t,this.getContentSlot())}},render:function(t){return t("div",{staticClass:"v-dialog__container",class:{"v-dialog__container--attached":""===this.attach||!0===this.attach||"attach"===this.attach},attrs:{role:"dialog"}},[this.genActivator(),this.genContent()])}}),R=n("4bd4"),L=n("132d"),M=n("e449"),N=n("0fd9"),F=n("1f4f"),P=n("2fa4"),Z=n("8654"),Q=n("a844"),W=n("71d9"),z=n("2a7f"),J=n("3a2f"),K=Object(h["a"])(u,i,a,!1,null,null,null);e["default"]=K.exports;m()(K,{VAutocomplete:v["a"],VBtn:p["a"],VCard:g["a"],VCardActions:b["a"],VCardText:b["b"],VCardTitle:b["c"],VCol:x["a"],VDatePicker:k["a"],VDialog:B,VForm:R["a"],VIcon:L["a"],VMenu:M["a"],VRow:N["a"],VSimpleTable:F["a"],VSpacer:P["a"],VTextField:Z["a"],VTextarea:Q["a"],VToolbar:W["a"],VToolbarTitle:z["a"],VTooltip:J["a"]})}}]);
//# sourceMappingURL=chunk-f90ae5ac.c9abe375.js.map