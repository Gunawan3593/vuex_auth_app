(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d21abe4"],{bd8d:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-row",{attrs:{align:"center",justify:"center"}},[r("v-col",{attrs:{cols:"12",sm:"8",md:"12"}},[r("v-card",{staticClass:"elevation-12"},[r("v-toolbar",{attrs:{color:"primary",dark:"",flat:""}},[r("v-toolbar-title",[e._v("Add Purchase Receipt")]),r("v-spacer"),r("v-toolbar-title",[r("v-tooltip",{attrs:{left:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,s=t.attrs;return[r("v-btn",e._g(e._b({attrs:{icon:"",color:"dee-orange"},on:{click:function(t){return e.Back()}}},"v-btn",s,!1),a),[r("v-icon",[e._v("mdi-arrow-left-bold")])],1)]}}])},[r("span",[e._v("Back to List")])]),r("v-tooltip",{attrs:{left:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,s=t.attrs;return[r("v-btn",e._g(e._b({attrs:{icon:"",color:"dee-orange",link:"",to:"/purchase/receipt/add"}},"v-btn",s,!1),a),[r("v-icon",[e._v("mdi-restore")])],1)]}}])},[r("span",[e._v("New Data")])]),r("v-tooltip",{attrs:{left:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,s=t.attrs;return[r("v-btn",e._g(e._b({attrs:{icon:"",color:"dee-orange",loading:e.isLoading,disabled:e.isLoading},on:{click:e.submit}},"v-btn",s,!1),a),[r("v-icon",[e._v("mdi-content-save-move-outline")])],1)]}}])},[r("span",[e._v("Save Data")])])],1)],1),r("v-card-text",[r("v-form",[r("v-row",[r("v-col",{attrs:{cols:"12",sm:"12",md:"4"}},[r("v-text-field",{attrs:{label:"No.","prepend-icon":"mdi-numeric",type:"text",readonly:""},model:{value:e.fields.no,callback:function(t){e.$set(e.fields,"no",t)},expression:"fields.no"}})],1),r("v-col",{attrs:{cols:"12",sm:"12",md:"4"}},[r("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"290px"},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[r("v-text-field",e._g({attrs:{label:"Date","prepend-icon":"mdi-calendar",readonly:""},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}},a))]}}]),model:{value:e.menu,callback:function(t){e.menu=t},expression:"menu"}},[r("v-date-picker",{on:{input:function(t){e.menu=!1}},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}})],1)],1),r("v-col",{attrs:{cols:"12",sm:"12",md:"4"}},[r("v-autocomplete",{attrs:{"error-messages":e.supplierErrors,required:"",items:e.supplierItems,"hide-no-data":"","hide-selected":"","item-text":"Description","item-value":"_id",label:"Supplier",placeholder:"Start typing to Search","prepend-icon":"mdi-dresser","return-object":!1},on:{change:function(t){return e.loadOrder(t)},input:function(t){return e.$v.fields.supplier.$touch()},blur:function(t){return e.$v.fields.supplier.$touch()}},model:{value:e.fields.supplier,callback:function(t){e.$set(e.fields,"supplier",t)},expression:"fields.supplier"}})],1)],1)],1),r("v-row",[r("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[r("v-autocomplete",{attrs:{"error-messages":e.orderErrors,required:"",items:e.orderItems,"hide-no-data":"","hide-selected":"","item-text":"Description","item-value":"_id",label:"Order",placeholder:"Start typing to Search","prepend-icon":"mdi-cart-outline","return-object":!1},on:{change:function(t){return e.getOrderItem(t)},input:function(t){return e.$v.fields.order.$touch()},blur:function(t){return e.$v.fields.order.$touch()}},model:{value:e.fields.order,callback:function(t){e.$set(e.fields,"order",t)},expression:"fields.order"}})],1),r("v-col",{attrs:{cols:"12",sm:"6",md:"8"}},[r("p",{staticClass:"display-2 text-right",staticStyle:{"padding-right":"10px"}},[e._v("Total : "+e._s(e._f("currency")(e.getSubtotal)))])])],1),r("v-row",[r("v-col",{attrs:{cols:"12",sm:"12",md:"12"}},[r("v-simple-table",{attrs:{dense:""},scopedSlots:e._u([{key:"default",fn:function(){return[r("thead",[r("tr",[r("th",{staticClass:"text-center"},[e._v("Name")]),r("th",{staticClass:"text-center",attrs:{width:"100px"}},[e._v("Order")]),r("th",{staticClass:"text-center",attrs:{width:"100px"}},[e._v("Qty")]),r("th",{staticClass:"text-center",attrs:{width:"200px;"}},[e._v("Cost")]),r("th",{staticClass:"text-center",attrs:{width:"200px;"}},[e._v("Total")])])]),r("tbody",e._l(e.fields.items,(function(t,a){return r("tr",{key:t.product},[r("td",[e._v(e._s(t.name))]),r("td",[e._v(e._s(t.order_qty))]),r("td",[r("v-currency-field",{attrs:{"decimal-length":0,"place-holder":"Qty"},on:{change:function(t){return e.checkQty(a)}},model:{value:t.qty,callback:function(r){e.$set(t,"qty",r)},expression:"item.qty"}})],1),r("td",{staticClass:"text-right"},[e._v(e._s(e._f("currency")(t.cost)))]),r("td",{staticClass:"text-right"},[e._v(e._s(e._f("currency")(t.qty*t.cost)))])])})),0)]},proxy:!0}])})],1)],1),r("v-row",[r("v-col",{attrs:{cols:"12",md:"6"}},[r("v-textarea",{attrs:{"prepend-icon":"mdi-note-text-outline",label:"Notes",value:"fields.notes",rows:"3"},model:{value:e.fields.notes,callback:function(t){e.$set(e.fields,"notes",t)},expression:"fields.notes"}})],1)],1)],1)],1)],1)],1)},s=[],i=(r("4160"),r("d81d"),r("fb6a"),r("b0c0"),r("d3b7"),r("25f0"),r("159b"),r("96cf"),r("1da1")),n=r("5530"),o=r("1dce"),d=r("b5ae"),c=r("2f62"),u={mixins:[o["validationMixin"]],validations:{fields:{supplier:{required:d["required"]},order:{required:d["required"]}}},computed:Object(n["a"])(Object(n["a"])({},Object(c["c"])(["user","purchaseOrderStatus"])),{},{supplierErrors:function(){var e=[];return this.$v.fields.supplier.$dirty?(!this.$v.fields.supplier.required&&e.push("Supplier is required."),e):e},orderErrors:function(){var e=[];return this.$v.fields.order.$dirty?(!this.$v.fields.order.required&&e.push("Order is required."),e):e},supplierItems:function(){return this.suppliers.map((function(e){var t=e.name;return Object.assign({},e,{Description:t})}))},orderItems:function(){return this.orders.map((function(e){var t=e.no;return Object.assign({},e,{Description:t})}))},getSubtotal:function(){var e=this.fields.items;if(0!=e.length){for(var t=0,r=0;r<e.length;r++)t+=e[r].qty*e[r].cost;return t}}}),data:function(){return{fields:{id:!1,no:"",transdate:"",order:"",supplier:"",notes:"",user:"",items:[]},date:"",suppliers:[],orders:[],products:[],isLoading:!1,menu:!1,page:""}},mounted:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r,a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getSupplier();case 2:r=t.sent,a=r.data.data,a&&(e.suppliers=a),s=e.$route.params.id,void 0!=s?e.loadData(s):e.reset();case 7:case"end":return t.stop()}}),t)})))()},created:function(){var e=this.$route.query.page;this.page=e},methods:Object(n["a"])(Object(n["a"])({},Object(c["b"])(["getPrNo","getSupplier","addPurchaseReceipt","getPoItem","getPrItem","updatePurchaseReceipt","getPurchaseReceipt","getPOReceivable"])),{},{getDateTime:function(e){var t=new Date(e),r=(new Date).getHours().toString(),a=(new Date).getMinutes().toString(),s=(new Date).getSeconds().toString(),i=("00"+r).substring(r.length)+":"+("00"+a).substring(a.length)+":"+("00"+s).substring(s.length);return t.toISOString().slice(0,10)+" "+i},loadData:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var a,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.getPurchaseReceipt(e);case 2:if(a=r.sent,void 0!=a){r.next=5;break}return r.abrupt("return",t.$router.push({name:"prlist"}));case 5:s=a.data.data,t.fields.id=e,t.fields.no=s.no,t.orders.push(s.order),t.fields.order=s.order._id,t.fields.notes=s.notes,t.fields.user=t.user._id,t.fields.supplier=s.supplier._id,t.getItem(e),t.fields.transdate=s.transdate,t.date=s.transdate.slice(0,10);case 16:case"end":return r.stop()}}),r)})))()},loadOrder:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var a,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.getPOReceivable(e);case 2:a=r.sent,s=a.data.data,t.orders=[],t.fields.items=[],void 0!=s&&s.forEach((function(e){t.orders.push(e)}));case 7:case"end":return r.stop()}}),r)})))()},addData:function(){var e=this;this.isLoading=!0,this.addPurchaseReceipt(this.fields).then((function(t){t.data.success&&(e.isLoading=!1,e.$router.push("/purchase/receipt/list"))}))},updateData:function(){var e=this;this.isLoading=!0,this.updatePurchaseReceipt(this.fields).then((function(t){t.data.success&&(e.isLoading=!1,e.$router.push({name:"prlist",params:{page:e.page}}))}))},reset:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getPrNo();case 2:r=t.sent,e.fields.id=!1,e.fields.no=r.data.code,e.date=(new Date).toISOString().slice(0,10),e.fields.supplier="",e.fields.notes="",e.fields.items=[],e.fields.user=e.user._id,e.fields.transdate=new Date;case 11:case"end":return t.stop()}}),t)})))()},getItem:function(e){var t=this,r={receipt:e};this.getPrItem(r).then((function(e){if(e.data.success){var r=e.data.data;t.fields.items=[],r.forEach((function(e){e={name:e.product.name,order_item:e.order_item._id,product:e.product._id,cost:e.cost,order_qty:e.qty+(e.order_item.qty-e.order_item.rcv_qty),qty:e.qty},t.fields.items.push(e)}))}}))},getOrderItem:function(e){var t=this,r={order:e};this.getPoItem(r).then((function(e){if(e.data.success){var r=e.data.data;t.fields.items=[],r.forEach((function(e){e.qty-e.rcv_qty>0&&(e={name:e.product.name,order_item:e._id,product:e.product._id,cost:e.cost,order_qty:e.qty-e.rcv_qty,qty:e.qty-e.rcv_qty},t.fields.items.push(e))}))}}))},Back:function(){this.$router.push({name:"prlist",params:{page:this.page}})},checkQty:function(e){var t=this.fields.items[e];t.qty>t.order_qty&&(t.qty=t.order_qty)},submit:function(){this.fields.transdate=this.getDateTime(this.date),this.$v.$touch(),this.$v.$error||(this.fields.id?this.updateData():this.addData())}})},l=u,p=r("2877"),f=r("6544"),v=r.n(f),m=r("c6a6"),h=r("8336"),g=r("b0af"),b=r("99d9"),_=r("62ad"),y=r("2e4b"),x=r("4bd4"),w=r("132d"),q=r("e449"),k=r("0fd9"),$=r("1f4f"),S=r("2fa4"),O=r("8654"),D=r("a844"),R=r("71d9"),V=r("2a7f"),j=r("3a2f"),P=Object(p["a"])(l,a,s,!1,null,null,null);t["default"]=P.exports;v()(P,{VAutocomplete:m["a"],VBtn:h["a"],VCard:g["a"],VCardText:b["b"],VCol:_["a"],VDatePicker:y["a"],VForm:x["a"],VIcon:w["a"],VMenu:q["a"],VRow:k["a"],VSimpleTable:$["a"],VSpacer:S["a"],VTextField:O["a"],VTextarea:D["a"],VToolbar:R["a"],VToolbarTitle:V["a"],VTooltip:j["a"]})}}]);
//# sourceMappingURL=chunk-2d21abe4.b49e50c0.js.map